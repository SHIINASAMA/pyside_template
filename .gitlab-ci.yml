build:
  stage: build
  tags:
    - windows
  script:
    - uv sync
    - uv run build.py --all --onefile
  rules:
    - if: $CI_COMMIT_BRANCH == $CI_DEFAULT_BRANCH
      changes:
        - app/**
        - pyproject.toml
        - uv.lock
        - build.py
        - .gitlab-ci.yml
  artifacts:
    name: "build-${CI_COMMIT_SHA}"
    paths:
      - build/App.exe
    expire_in: 30 days
